---
title: 工作常用Word宏
tags: [word,宏,效率]
categories:
  - 金融狗工作日常
timestamp: pt=0509230140
date: 2018-05-09 23:01:40
---
所有的投行承做应该都遇到过同一个问题，就是全文的表格格式，这调整起来比普通的文字调整要累的多。普通文字最多就是刷下字体，然后调整下大纲级别、行距、字体以及缩进等。但表格的花样就很多了。下面放几个我最常用到的宏命令。<!--more-->`具体怎么用？你都想着宏了，怎么把宏放到word里还不会？度娘吧！`

你们先看看我这个样式，还是比较清爽的吧。“单位：万元”与表格紧贴，用的就是`unit_form`这个宏，表格具体的样式，后面几个宏刷出来都是一样的，只是应用的范围不同而已。

![Sample](https://file.kmore.ml/blog_img/20200210225017.png)
"还算比较清爽的表格样例")

> **单位紧贴**

```vb
Sub unit_form()
'
'调整表头单位部分格式，取消行距等，并右对齐
'
'
    Selection.ParagraphFormat.Alignment = wdAlignParagraphRight
     With Selection.ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 0
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .Alignment = wdAlignParagraphRight
        .WidowControl = False
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .CollapsedByDefault = False
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
End Sub
```

> **表格样式刷**

下面这几个有相似之处，不同场景下使用对应的。只要调整单一表格的情况，全文表格要改的情况以及要改全文但是可以有不同表格宽度的时候（比如三年一期或者两年一期的）。具体样式，自行琢磨着根据自家的style调整吧。

```vb
Sub chart_form()
'
'设置选中单一表格宽度为窗口大小，修改行高为至少0.6cm，字体为宋/times new roman，居中
'
'
    Selection.Tables(1).AutoFitBehavior (wdAutoFitWindow)
    Selection.Tables(1).AutoFitBehavior (wdAutoFitWindow)
    Selection.Rows.HeightRule = wdRowHeightAtLeast
    Selection.Rows.Height = CentimetersToPoints(0.6)
    Selection.Cells.VerticalAlignment = wdCellAlignVerticalCenter
    Selection.Rows.HeadingFormat = wdToggle
    Selection.Rows.HeadingFormat = wdToggle
    Selection.Font.Name = "宋体"
    Selection.Font.Name = "Times New Roman"
    Selection.SelectCell
    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
    Selection.Cells.VerticalAlignment = wdCellAlignVerticalCenter
    Selection.Font.Size = 9
    Options.DefaultHighlightColorIndex = wdNoHighlight
    Selection.Range.HighlightColorIndex = wdNoHighlight
    Selection.Shading.Texture = wdTextureNone
    Selection.Shading.ForegroundPatternColor = wdColorAutomatic
    Selection.Shading.BackgroundPatternColor = wdColorAutomatic
    With Selection.ParagraphFormat
        .LeftIndent = CentimetersToPoints(0)
        .RightIndent = CentimetersToPoints(0)
        .SpaceBefore = 0
        .SpaceBeforeAuto = False
        .SpaceAfter = 0
        .SpaceAfterAuto = False
        .LineSpacingRule = wdLineSpaceSingle
        .WidowControl = False
        .KeepWithNext = False
        .KeepTogether = False
        .PageBreakBefore = False
        .NoLineNumber = False
        .Hyphenation = True
        .FirstLineIndent = CentimetersToPoints(0)
        .OutlineLevel = wdOutlineLevelBodyText
        .CharacterUnitLeftIndent = 0
        .CharacterUnitRightIndent = 0
        .CharacterUnitFirstLineIndent = 0
        .LineUnitBefore = 0
        .LineUnitAfter = 0
        .MirrorIndents = False
        .TextboxTightWrap = wdTightNone
        .CollapsedByDefault = False
        .AutoAdjustRightIndent = True
        .DisableLineHeightGrid = False
        .FarEastLineBreakControl = True
        .WordWrap = True
        .HangingPunctuation = True
        .HalfWidthPunctuationOnTopOfLine = False
        .AddSpaceBetweenFarEastAndAlpha = True
        .AddSpaceBetweenFarEastAndDigit = True
        .BaseLineAlignment = wdBaselineAlignAuto
    End With
    With Selection.Tables(1)
        .Borders(wdBorderLeft).LineStyle = wdLineStyleNone
        .Borders(wdBorderRight).LineStyle = wdLineStyleNone
        With .Borders(wdBorderTop)
            .LineStyle = wdLineStyleDouble
            .LineWidth = wdLineWidth050pt
            .Color = wdColorBlack
        End With
        With .Borders(wdBorderBottom)
            .LineStyle = wdLineStyleDouble
            .LineWidth = wdLineWidth050pt
            .Color = wdColorBlack
        End With
        With .Borders(wdBorderHorizontal)
            .LineStyle = wdLineStyleSingle
            .LineWidth = wdLineWidth050pt
            .Color = wdColorBlack
        End With
        With .Borders(wdBorderVertical)
            .LineStyle = wdLineStyleSingle
            .LineWidth = wdLineWidth050pt
            .Color = wdColorBlack
        End With
        .Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
        .Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
        .Borders.Shadow = False
    End With
    With Options
        .DefaultBorderLineStyle = wdLineStyleSingle
        .DefaultBorderLineWidth = wdLineWidth050pt
        .DefaultBorderColor = wdColorBlack
    End With
End Sub
```


```vb
Sub ChangeTable()
'
'全文设置表格宽度为窗口大小，修改行高为至少0.6cm，字体为宋/times new roman，居中
'

Application.Browser.Target = wdBrowseTable
    For i = 1 To ActiveDocument.Tables.Count
        ActiveDocument.Tables(i).AutoFitBehavior (wdAutoFitWindow)
        ActiveDocument.Tables(i).AutoFitBehavior (wdAutoFitWindow)
        ActiveDocument.Tables.Item(i).Select
        With Selection
            .Rows.HeightRule = wdRowHeightAtLeast
            .Rows.Height = CentimetersToPoints(0.6)
            .Cells.VerticalAlignment = wdCellAlignVerticalCenter
            .Rows.HeadingFormat = wdToggle
            .Rows.HeadingFormat = wdToggle
            .Font.Name = "宋体"
            .Font.Name = "Times New Roman"
            .SelectCell
            .ParagraphFormat.Alignment = wdAlignParagraphCenter
            .Cells.VerticalAlignment = wdCellAlignVerticalCenter
            .Font.Size = 9
            .Font.Color = wdColorAutomatic
            .Range.HighlightColorIndex = wdNoHighlight
            .Shading.Texture = wdTextureNone
            .Shading.ForegroundPatternColor = wdColorAutomatic
            .Shading.BackgroundPatternColor = wdColorAutomatic
            .Borders(wdBorderLeft).LineStyle = wdLineStyleNone
            .Borders(wdBorderRight).LineStyle = wdLineStyleNone
            With .Borders(wdBorderTop)
                .LineStyle = wdLineStyleDouble
                .LineWidth = wdLineWidth050pt
                .Color = wdColorBlack
            End With
            With .Borders(wdBorderBottom)
                .LineStyle = wdLineStyleDouble
                .LineWidth = wdLineWidth050pt
                .Color = wdColorBlack
            End With
            With .Borders(wdBorderHorizontal)
                .LineStyle = wdLineStyleSingle
                .LineWidth = wdLineWidth050pt
                .Color = wdColorBlack
            End With
            With .Borders(wdBorderVertical)
                .LineStyle = wdLineStyleSingle
                .LineWidth = wdLineWidth050pt
                .Color = wdColorBlack
            End With
            .Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
            .Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
            .Borders.Shadow = False
            With .ParagraphFormat
                .LeftIndent = CentimetersToPoints(0)
                .RightIndent = CentimetersToPoints(0)
                .SpaceBefore = 0
                .SpaceBeforeAuto = False
                .SpaceAfter = 0
                .SpaceAfterAuto = False
                .LineSpacingRule = wdLineSpaceSingle
                .WidowControl = False
                .KeepWithNext = False
                .KeepTogether = False
                .PageBreakBefore = False
                .NoLineNumber = False
                .Hyphenation = True
                .FirstLineIndent = CentimetersToPoints(0)
                .OutlineLevel = wdOutlineLevelBodyText
                .CharacterUnitLeftIndent = 0
                .CharacterUnitRightIndent = 0
                .CharacterUnitFirstLineIndent = 0
                .LineUnitBefore = 0
                .LineUnitAfter = 0
                .MirrorIndents = False
                .TextboxTightWrap = wdTightNone
                .CollapsedByDefault = False
                .AutoAdjustRightIndent = True
                .DisableLineHeightGrid = False
                .FarEastLineBreakControl = True
                .WordWrap = True
                .HangingPunctuation = True
                .HalfWidthPunctuationOnTopOfLine = False
                .AddSpaceBetweenFarEastAndAlpha = True
                .AddSpaceBetweenFarEastAndDigit = True
                .BaseLineAlignment = wdBaselineAlignAuto
            End With
            With Options
                .DefaultBorderLineStyle = wdLineStyleSingle
                .DefaultBorderLineWidth = wdLineWidth050pt
                .DefaultBorderColor = wdColorBlack
                .DefaultHighlightColorIndex = wdNoHighlight
            End With
        End With
    Next i
End Sub
```


```vb
Sub ChangeTable2()
'
'不改变表格宽度，修改行高为至少0.6cm，字体为宋/times new roman，居中
'
Application.Browser.Target = wdBrowseTable
    For i = 1 To ActiveDocument.Tables.Count
        'ActiveDocument.Tables(i).AutoFitBehavior (wdAutoFitWindow)
        'ActiveDocument.Tables(i).AutoFitBehavior (wdAutoFitWindow)
        ActiveDocument.Tables.Item(i).Select
        With Selection
            .Rows.HeightRule = wdRowHeightAtLeast
            .Rows.Height = CentimetersToPoints(0.6)
            .Cells.VerticalAlignment = wdCellAlignVerticalCenter
            .Rows.HeadingFormat = wdToggle
            .Rows.HeadingFormat = wdToggle
            .Font.Name = "宋体"
            .Font.Name = "Times New Roman"
            .SelectCell
            .ParagraphFormat.Alignment = wdAlignParagraphCenter
            .Cells.VerticalAlignment = wdCellAlignVerticalCenter
            .Font.Size = 9
            .Font.Color = wdColorAutomatic
            .Range.HighlightColorIndex = wdNoHighlight
            .Shading.Texture = wdTextureNone
            .Shading.ForegroundPatternColor = wdColorAutomatic
            .Shading.BackgroundPatternColor = wdColorAutomatic
            .Borders(wdBorderLeft).LineStyle = wdLineStyleNone
            .Borders(wdBorderRight).LineStyle = wdLineStyleNone
            With .Borders(wdBorderTop)
                .LineStyle = wdLineStyleDouble
                .LineWidth = wdLineWidth050pt
                .Color = wdColorBlack
            End With
            With .Borders(wdBorderBottom)
                .LineStyle = wdLineStyleDouble
                .LineWidth = wdLineWidth050pt
                .Color = wdColorBlack
            End With
            With .Borders(wdBorderHorizontal)
                .LineStyle = wdLineStyleSingle
                .LineWidth = wdLineWidth050pt
                .Color = wdColorBlack
            End With
            With .Borders(wdBorderVertical)
                .LineStyle = wdLineStyleSingle
                .LineWidth = wdLineWidth050pt
                .Color = wdColorBlack
            End With
            .Borders(wdBorderDiagonalDown).LineStyle = wdLineStyleNone
            .Borders(wdBorderDiagonalUp).LineStyle = wdLineStyleNone
            .Borders.Shadow = False
            With .ParagraphFormat
                .LeftIndent = CentimetersToPoints(0)
                .RightIndent = CentimetersToPoints(0)
                .SpaceBefore = 0
                .SpaceBeforeAuto = False
                .SpaceAfter = 0
                .SpaceAfterAuto = False
                .LineSpacingRule = wdLineSpaceSingle
                .WidowControl = False
                .KeepWithNext = False
                .KeepTogether = False
                .PageBreakBefore = False
                .NoLineNumber = False
                .Hyphenation = True
                .FirstLineIndent = CentimetersToPoints(0)
                .OutlineLevel = wdOutlineLevelBodyText
                .CharacterUnitLeftIndent = 0
                .CharacterUnitRightIndent = 0
                .CharacterUnitFirstLineIndent = 0
                .LineUnitBefore = 0
                .LineUnitAfter = 0
                .MirrorIndents = False
                .TextboxTightWrap = wdTightNone
                .CollapsedByDefault = False
                .AutoAdjustRightIndent = True
                .DisableLineHeightGrid = False
                .FarEastLineBreakControl = True
                .WordWrap = True
                .HangingPunctuation = True
                .HalfWidthPunctuationOnTopOfLine = False
                .AddSpaceBetweenFarEastAndAlpha = True
                .AddSpaceBetweenFarEastAndDigit = True
                .BaseLineAlignment = wdBaselineAlignAuto
            End With
            With Options
                .DefaultBorderLineStyle = wdLineStyleSingle
                .DefaultBorderLineWidth = wdLineWidth050pt
                .DefaultBorderColor = wdColorBlack
                .DefaultHighlightColorIndex = wdNoHighlight
            End With
        End With
    Next i
End Sub
```

全选所有表格的功能，用到的可能性很小。但也放一下了。
```vb
Sub SelectAllTables()
'
'选择全文表格
'
Dim tempTable As Table
Application.ScreenUpdating = False
'删除所有可编辑的区域
ActiveDocument.DeleteAllEditableRanges wdEditorEveryone
'添加可编辑区域
For Each tempTable In ActiveDocument.Tables
	tempTable.Range.Editors.Add wdEditorEveryone
Next
'选中所有可编辑区域
ActiveDocument.SelectAllEditableRanges wdEditorEveryone
'删除所有可编辑的区域
ActiveDocument.DeleteAllEditableRanges wdEditorEveryone
Application.ScreenUpdating = True

End Sub

```